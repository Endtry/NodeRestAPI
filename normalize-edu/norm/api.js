var _0x2ba5=['process','role','EmailCron','scheduleMassPasswordReset','_AAName','MSSQLToPG','run','handleError','development','unhandledRejection','environment','status','send','socket','from\x20api.ts\x20req\x20socket\x20err','select\x20*\x20from\x20\x22App\x22\x20where\x20\x22active\x22\x20=\x20true\x20and\x20\x22primary\x22\x20=\x20false','DB_NAME','forEach','spawn','configureMiddleware','configureCron','readyCallback','onReadyCallback','onReady','importModel','routePrefix','../../seed','name','controller','pop','select\x20*\x20from\x20\x22User\x22','filter','super_admin','isMaster','createServer','listening','Server\x20is\x20running\x20and\x20serving:\x20','\x20by\x20Worker\x20PID:\x20','pid','address','connection','code','EADDRINUSE','\x20is\x20in\x20use\x20by\x20worker\x20pid:\x20','close','listen','restartWorkers','workers','shutdown','master','kill','SIGKILL','API','__awaiter','next','throw','done','value','then','defineProperty','__esModule','express','morgan','body-parser','BaseModel','./migration/mssql-to-postgres','./cron/cron','http','cors','mongoose','passport','passport-local','express-jwt','bcrypt','cluster','cookie-parser','express-session','options','models','initialized','cachedModels','server','app','port','configureDatabase','dbExistCheck','query','log','Error\x20while\x20connecting:\x20','stack','rows','pool','error','idle\x20client\x20error','message','postgres://','dbUser','dbPassword','dbHost','dbPort','/postgres','Client','connect','select\x20count(*)\x20from\x20pg_catalog.pg_database\x20where\x20lower(datname)\x20=\x20lower(\x27','dbName','createDatabase','CREATE\x20DATABASE\x20\x22','\x22\x20OWNER\x20','dbType','mongo','connectionString','conn\x20string','database\x20set\x20to\x20',',\x20and\x20is\x20connected\x20to\x20','initialize','getDBInstance','use','json','35mb','getSessConfig','Session','env','SESSION_SECRET','configureRoutes','bootstrap','createModel','schema','indexOf','N/A','length','model','push','toLowerCase','router','make','keys','map','all','init','ready','seed','seedDir','processModels','reduce','resolve','sortModels','getFkeys','sort','keyCount','configureJWT','superAdminExistCheck','production','splice','headers','authorization','split','Bearer','token','configureCors','origin','corsWhitelist','Origin:\x20','\x20is\x20not\x20allowed\x20to\x20access\x20API!','worker'];(function(_0x3c6e08,_0x92d1c6){var _0x414088=function(_0x2b7c6d){while(--_0x2b7c6d){_0x3c6e08['push'](_0x3c6e08['shift']());}};_0x414088(++_0x92d1c6);}(_0x2ba5,0x17d));var _0x403e=function(_0x17f083,_0x430281){_0x17f083=_0x17f083-0x0;var _0x38a250=_0x2ba5[_0x17f083];return _0x38a250;};'use strict';var __awaiter=this&&this[_0x403e('0x0')]||function(_0x358383,_0xf38f0b,_0x554f1d,_0x398207){return new(_0x554f1d||(_0x554f1d=Promise))(function(_0x389a01,_0x503687){function _0x566bf4(_0x536702){try{_0x1067d9(_0x398207[_0x403e('0x1')](_0x536702));}catch(_0x4f6be7){_0x503687(_0x4f6be7);}}function _0x33ce1a(_0x1aebb0){try{_0x1067d9(_0x398207[_0x403e('0x2')](_0x1aebb0));}catch(_0x206f1b){_0x503687(_0x206f1b);}}function _0x1067d9(_0x48485e){_0x48485e[_0x403e('0x3')]?_0x389a01(_0x48485e[_0x403e('0x4')]):new _0x554f1d(function(_0x389a01){_0x389a01(_0x48485e['value']);})[_0x403e('0x5')](_0x566bf4,_0x33ce1a);}_0x1067d9((_0x398207=_0x398207['apply'](_0x358383,_0xf38f0b||[]))[_0x403e('0x1')]());});};Object[_0x403e('0x6')](exports,_0x403e('0x7'),{'value':!![]});const express=require(_0x403e('0x8'));const logger=require(_0x403e('0x9'));const bodyParser=require(_0x403e('0xa'));const base_model_1=require('./models/base.model');exports[_0x403e('0xb')]=base_model_1[_0x403e('0xb')];const mssql_to_postgres_1=require(_0x403e('0xc'));const email_cron_1=require('./cron/email.cron');const cron_1=require(_0x403e('0xd'));const pg=require('pg');const http=require(_0x403e('0xe'));const cors=require(_0x403e('0xf'));const mongoose=require(_0x403e('0x10'));const passport=require(_0x403e('0x11'));const Strategy=require(_0x403e('0x12'));const expressJWT=require(_0x403e('0x13'));const bcrypt=require(_0x403e('0x14'));const helmet=require('helmet');const compression=require('compression');const cluster=require(_0x403e('0x15'));const cookieParser=require(_0x403e('0x16'));const session=require(_0x403e('0x17'));const pgSession=require('connect-pg-simple')(session);class API{constructor(_0x3de36a){this[_0x403e('0x18')]=_0x3de36a;this['pool']=null;this[_0x403e('0x19')]=[];this['schema']=[];this[_0x403e('0x1a')]=![];this[_0x403e('0x1b')]=[];this[_0x403e('0x1c')]=null;this[_0x403e('0x1d')]=express();this['port']=_0x3de36a[_0x403e('0x1e')]||0xbb8;this['cronManager']=new cron_1['Cron'](_0x3de36a,cluster);this[_0x403e('0x1f')](this[_0x403e('0x1d')],_0x3de36a);}[_0x403e('0x20')](_0x51b4c2,_0x10793e){return new Promise(_0x1662a3=>{_0x51b4c2[_0x403e('0x21')](_0x10793e,(_0x53bb20,_0x3daa66)=>{if(_0x53bb20){console[_0x403e('0x22')](_0x403e('0x23')+_0x53bb20[_0x403e('0x24')]);_0x1662a3(![]);}else{if(_0x3daa66[_0x403e('0x25')][0x0]['count']==0x0){_0x1662a3(![]);}else{_0x1662a3(!![]);}}});});}['getDBInstance'](_0x439844,_0x21e811,_0x211c63){return new Promise(_0x4d3e05=>__awaiter(this,void 0x0,void 0x0,function*(){if(!this['db']){this['pool']=new pg['Pool'](_0x439844);this[_0x403e('0x26')]['on'](_0x403e('0x27'),(_0x3f52b9,_0xee133b)=>{console[_0x403e('0x27')](_0x403e('0x28'),_0x3f52b9[_0x403e('0x29')],_0x3f52b9[_0x403e('0x24')]);});let _0x183ca3=_0x403e('0x2a')+_0x21e811[_0x403e('0x2b')]+':'+_0x21e811[_0x403e('0x2c')]+'@'+_0x21e811[_0x403e('0x2d')]+':'+_0x21e811[_0x403e('0x2e')]+_0x403e('0x2f');let _0x182649=new pg[(_0x403e('0x30'))](_0x183ca3);_0x182649[_0x403e('0x31')]();let _0x27cfe1=_0x403e('0x32')+_0x21e811[_0x403e('0x33')]+'\x27)';const _0x1dd939=yield this['dbExistCheck'](_0x182649,_0x27cfe1);if(!_0x1dd939){let _0x530401=yield this[_0x403e('0x34')](_0x182649,_0x21e811);}else{}this['db']==null?this['db']={'query':null,'connect':null}:null;this['db']={'query':(_0x22549f,_0x545041,_0x46dac6)=>{return this['pool'][_0x403e('0x21')](_0x22549f,_0x545041,(_0x4a2901,_0x53bf6e)=>{_0x46dac6(_0x4a2901,_0x53bf6e);});},'connect':_0x8179a4=>{return this[_0x403e('0x26')][_0x403e('0x31')]((_0xe49543,_0x182649,_0x366d5f)=>{_0x8179a4(_0xe49543,_0x182649,_0x366d5f);});}};_0x4d3e05(this['db']);return this['db'];}else{_0x4d3e05(this['db']);return this['db'];}}));}[_0x403e('0x34')](_0x4374f0,_0x160536){return new Promise(_0x5763ba=>{const _0xa42d2b=_0x403e('0x35')+_0x160536[_0x403e('0x33')]+_0x403e('0x36')+_0x160536[_0x403e('0x2b')];_0x4374f0[_0x403e('0x21')](_0xa42d2b,(_0x35df7d,_0x1e7f0d)=>{if(_0x35df7d){console[_0x403e('0x22')]('create\x20database\x20error',_0x35df7d);setTimeout(()=>{_0x5763ba(_0x35df7d);},0x1770);throw new Error(_0x35df7d);}else{setTimeout(()=>{_0x5763ba(_0x1e7f0d);},0x1770);}});});}[_0x403e('0x1f')](_0x1e27b4,_0x497488){return __awaiter(this,void 0x0,void 0x0,function*(){return new Promise(_0x4f9368=>__awaiter(this,void 0x0,void 0x0,function*(){let _0x17b12e;switch(_0x497488[_0x403e('0x37')]){case _0x403e('0x38'):mongoose[_0x403e('0x31')](this[_0x403e('0x18')][_0x403e('0x39')]);console[_0x403e('0x22')](_0x403e('0x3a'),this[_0x403e('0x18')][_0x403e('0x39')]);console[_0x403e('0x22')](_0x403e('0x3b')+this[_0x403e('0x18')][_0x403e('0x37')]+_0x403e('0x3c')+this[_0x403e('0x18')][_0x403e('0x33')]);_0x17b12e=yield this[_0x403e('0x3d')](_0x1e27b4,_0x497488);break;case'postgres':let _0x3cd160={'user':_0x497488[_0x403e('0x2b')],'database':_0x497488[_0x403e('0x33')],'password':_0x497488[_0x403e('0x2c')],'host':_0x497488[_0x403e('0x2d')],'port':_0x497488[_0x403e('0x2e')],'max':0x14,'idleTimeoutMillis':0xbb8,'connectionTimeoutMillis':0xbb8};const _0x939976=yield this[_0x403e('0x3e')](_0x3cd160,_0x497488);if(_0x939976){_0x17b12e=yield this[_0x403e('0x3d')](_0x1e27b4,_0x497488);yield this['loadTennancy'](_0x939976);}break;case'mysql':break;case'mssql':break;default:break;}_0x4f9368(_0x17b12e);}));});}['configureMiddleware'](_0x333b32){return new Promise(_0x14d619=>__awaiter(this,void 0x0,void 0x0,function*(){_0x333b32[_0x403e('0x3f')](logger('dev'));_0x333b32[_0x403e('0x3f')](bodyParser[_0x403e('0x40')]({'limit':_0x403e('0x41')}));_0x333b32[_0x403e('0x3f')](bodyParser['urlencoded']({'extended':![]}));_0x333b32[_0x403e('0x3f')](helmet());_0x333b32['use'](compression());_0x333b32[_0x403e('0x3f')](cookieParser());_0x333b32[_0x403e('0x3f')](session(yield this[_0x403e('0x42')]()));_0x14d619(!![]);}));}['getSessConfig'](){return new Promise(_0x1848cc=>{_0x1848cc({'store':new pgSession({'pool':this[_0x403e('0x26')],'tableName':_0x403e('0x43')}),'secret':process[_0x403e('0x44')][_0x403e('0x45')],'resave':![],'name':'sessID','saveUninitialized':![],'rolling':!![],'cookie':{'maxAge':0x1e*0x3c*0x3e8*0x4,'path':'/','httpOnly':!![]}});});}[_0x403e('0x46')](_0x47e998){return new Promise(_0x4ba6b3=>__awaiter(this,void 0x0,void 0x0,function*(){const _0x135e81=require('./models');setTimeout(()=>__awaiter(this,void 0x0,void 0x0,function*(){yield this[_0x403e('0x47')](_0x135e81,![]);_0x4ba6b3(!![]);}),0x3e8);}));}[_0x403e('0x48')](_0x3fbae1,_0x59abb1,_0x188a50,_0x3c7ea8){return new Promise(_0xde13d3=>__awaiter(this,void 0x0,void 0x0,function*(){let _0x392217;if(Object['keys'](_0x3fbae1[_0x403e('0x49')])[_0x403e('0x4a')](_0x59abb1)!=-0x1){_0xde13d3(_0x3fbae1['cachedModels'][_0x59abb1]);}else{if(_0x3c7ea8){let _0x32d05b=new _0x188a50[_0x59abb1](_0x3fbae1);const _0x4c0759=[..._0x32d05b['model']];_0x392217=new base_model_1[(_0x403e('0xb'))](_0x3fbae1[_0x403e('0x18')],_0x59abb1,_0x4c0759[0x0],_0x4c0759[0x1]!=null?_0x4c0759[0x1]:_0x403e('0x4b'),_0x4c0759[0x2]!=null&&_0x4c0759[0x2][_0x403e('0x4c')]>0x0?_0x4c0759[0x2]:[],_0x3fbae1);_0x32d05b['model']=_0x392217[_0x403e('0x4d')];}else{_0x392217=new _0x188a50[_0x59abb1](_0x3fbae1[_0x403e('0x18')],_0x59abb1,_0x3fbae1);}_0x3fbae1[_0x403e('0x19')][_0x403e('0x4e')](_0x392217[_0x403e('0x4d')]);_0x3fbae1['schema'][_0x59abb1]=_0x392217[_0x403e('0x4d')];_0x3fbae1[_0x403e('0x1d')][_0x403e('0x3f')](_0x3fbae1[_0x403e('0x18')]['routePrefix']+'/'+_0x59abb1[_0x403e('0x4f')](),_0x392217['model'][_0x403e('0x50')][_0x403e('0x51')]());_0x3fbae1[_0x403e('0x1b')][_0x59abb1]=_0x392217;_0xde13d3(_0x392217);}}));}[_0x403e('0x47')](_0x574313,_0x445df1){return new Promise(_0x28f629=>__awaiter(this,void 0x0,void 0x0,function*(){const _0x401285=_0x445df1!=null?_0x445df1:![];const _0x29fe1f=Object[_0x403e('0x52')](_0x574313)||[];const _0x7413df=_0x29fe1f[_0x403e('0x4c')]>0x0?_0x29fe1f[_0x403e('0x4c')]:0x0;const _0x47f9da=_0x29fe1f&&_0x29fe1f[_0x403e('0x4c')]>0x0?_0x29fe1f[_0x403e('0x53')]((_0x3bf103,_0x3b3f1f)=>__awaiter(this,void 0x0,void 0x0,function*(){return yield this[_0x403e('0x48')](this,_0x3bf103,_0x574313,_0x401285);})):[];let _0x28ebdd=_0x47f9da[_0x403e('0x4c')]>0x0?yield Promise[_0x403e('0x54')](_0x47f9da):[];let _0x3c17a9=_0x28ebdd[_0x403e('0x4c')]>0x0?_0x28ebdd[_0x403e('0x53')](_0x5920b4=>{return _0x5920b4[_0x403e('0x55')]();}):[];let _0x439a42=yield Promise['all'](_0x3c17a9);let _0x15f1f5=_0x439a42[_0x403e('0x4c')]>0x0?_0x439a42['filter'](_0x48f798=>!_0x48f798[_0x403e('0x56')]):[];let _0x5610ca=_0x15f1f5['length']>0x0?_0x15f1f5['map'](_0x2c1bac=>__awaiter(this,void 0x0,void 0x0,function*(){return _0x2c1bac[_0x403e('0x55')]();})):[];let _0x509c4f=_0x7413df==0x0||_0x7413df!=0x0&&_0x15f1f5[_0x403e('0x4c')]==0x0?!![]:![];if(!_0x509c4f){let _0x18267c=yield Promise['all'](_0x5610ca);_0x509c4f=!![];_0x28f629(!![]);}else{let _0x5e510e=_0x439a42['length']>0x0?_0x439a42[_0x403e('0x53')]((_0x23d1c3,_0x431cf5,_0x31be00)=>__awaiter(this,void 0x0,void 0x0,function*(){return _0x23d1c3[_0x403e('0x57')](this[_0x403e('0x18')][_0x403e('0x58')]!=null?this[_0x403e('0x18')]['seedDir']:'../../seed',_0x23d1c3['name']);})):[];let _0x5ef58d=_0x5e510e['length']>0x0?yield Promise[_0x403e('0x54')](_0x5e510e):!![];_0x28f629(_0x5ef58d);return _0x5ef58d;}}));}[_0x403e('0x59')](_0xcba9f0,_0xeaa3d4,_0x26cf80,_0x2f09e7){let _0xe710e=[];return _0xcba9f0[_0x403e('0x5a')]((_0x4b20ed,_0x48cc13)=>{return _0x4b20ed['then'](()=>{return _0x2f09e7(this,_0x48cc13,_0xeaa3d4,_0x26cf80)[_0x403e('0x5')](_0x4aa889=>{_0xe710e[_0x403e('0x4e')](_0x4aa889);return _0xe710e;});});},Promise[_0x403e('0x5b')]());}[_0x403e('0x5c')](_0x352aca){return __awaiter(this,void 0x0,void 0x0,function*(){return new Promise(_0x4521cc=>{let _0x369c57=[];let _0x5a80be=Object['keys'](_0x352aca)['reduce']((_0x4d5b1d,_0xc936a7,_0x562775,_0x212440)=>{return _0x4d5b1d[_0x403e('0x5')](()=>__awaiter(this,void 0x0,void 0x0,function*(){return this[_0x403e('0x5d')](_0xc936a7)[_0x403e('0x5')](_0x2ca029=>{_0x369c57['push'](_0x2ca029);return _0x369c57;});}));},Promise['resolve']());_0x5a80be[_0x403e('0x5')](_0x145b25=>{_0x4521cc(_0x145b25?_0x145b25[_0x403e('0x5e')]((_0x6544ec,_0xfde254)=>{return _0x6544ec[_0x403e('0x5f')]>_0xfde254['keyCount']?-0x1:0x1;}):![]);});});});}['getFkeys'](_0x3bf6dd){return new Promise(_0x388740=>__awaiter(this,void 0x0,void 0x0,function*(){let _0x5b0f86='SELECT\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20tc.constraint_name,\x20tc.table_name,\x20kcu.column_name,\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20ccu.table_name\x20AS\x20foreign_table_name,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20ccu.column_name\x20AS\x20foreign_column_name\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20FROM\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20information_schema.table_constraints\x20AS\x20tc\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20JOIN\x20information_schema.key_column_usage\x20AS\x20kcu\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20ON\x20tc.constraint_name\x20=\x20kcu.constraint_name\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20JOIN\x20information_schema.constraint_column_usage\x20AS\x20ccu\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20ON\x20ccu.constraint_name\x20=\x20tc.constraint_name\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20WHERE\x20constraint_type\x20=\x20\x27FOREIGN\x20KEY\x27\x20AND\x20tc.table_name=\x27'+_0x3bf6dd+'\x27;';this['db'][_0x403e('0x21')](_0x5b0f86,null,(_0x3a8806,_0x31cb10)=>{if(_0x31cb10&&_0x31cb10[_0x403e('0x25')]){_0x388740({'table':_0x3bf6dd,'keyCount':_0x31cb10[_0x403e('0x25')][_0x403e('0x4c')]});}});}));}[_0x403e('0x60')](_0x514cd3){return __awaiter(this,void 0x0,void 0x0,function*(){return new Promise(_0x5913cf=>__awaiter(this,void 0x0,void 0x0,function*(){const _0x2fbf49=yield this[_0x403e('0x61')]();if(_0x2fbf49){let _0x299fb7=[/\/api\/v1\/user\/login(?!\/renew)/,/\/api\/v1\/user\/recover-password/,/\/api\/v1\/user\/forgot-password/,/\/api\/v1\/user\/is-loggedin/,/\/api\/v1\/user\/create-secure/,/\/api\/v1\/user\/get-session-user/,/\/api\/v1\/app\/tennant/];_0x2fbf49&&this[_0x403e('0x18')]['environment']==_0x403e('0x62')?_0x299fb7[_0x403e('0x63')](_0x299fb7[_0x403e('0x4a')](/\/api\/v1\/user\/create-secure/,0x1)):null;_0x514cd3[_0x403e('0x3f')]('/',expressJWT({'secret':process[_0x403e('0x44')]['JWT_SECRET'],'credentialsRequired':!![],'getToken':_0x4aa36d=>{if(_0x4aa36d&&_0x4aa36d['headers']&&_0x4aa36d[_0x403e('0x64')][_0x403e('0x65')]&&_0x4aa36d[_0x403e('0x64')][_0x403e('0x65')][_0x403e('0x66')]('\x20')[0x0]===_0x403e('0x67')){return _0x4aa36d[_0x403e('0x64')][_0x403e('0x65')]['split']('\x20')[0x1];}else if(_0x4aa36d&&_0x4aa36d[_0x403e('0x21')]&&_0x4aa36d[_0x403e('0x21')]['token']){return _0x4aa36d['query'][_0x403e('0x68')];}return null;}})['unless']({'path':_0x299fb7}));_0x5913cf(!![]);}else{_0x5913cf(![]);}}));});}[_0x403e('0x69')](_0x9379e3){return new Promise(_0x28bf55=>{let _0x310764=![];_0x9379e3[_0x403e('0x3f')]((_0x12cda5,_0x213576,_0x270331)=>{_0x310764=_0x12cda5['headers'][_0x403e('0x6a')]===undefined;_0x12cda5[_0x403e('0x64')]['origin']=_0x12cda5[_0x403e('0x64')][_0x403e('0x6a')]||_0x12cda5[_0x403e('0x64')]['host'];_0x270331();});const _0x5c3eb8=this[_0x403e('0x18')][_0x403e('0x6b')];const _0x3c5840={'origin':(_0x26b8dc,_0x59f1a7)=>{if(_0x310764||_0x5c3eb8[_0x403e('0x4a')](_0x26b8dc)!==-0x1){_0x59f1a7(null,!![]);}else{_0x59f1a7(new Error(_0x403e('0x6c')+_0x26b8dc+_0x403e('0x6d')));}},'credentials':!![]};_0x9379e3[_0x403e('0x18')]('*',cors(_0x3c5840));_0x9379e3[_0x403e('0x3f')](cors(_0x3c5840));_0x28bf55(!![]);});}['configureCron'](_0x1595d9,_0x393187,_0x3dfe14){return new Promise(_0x2fde6f=>{if(this[_0x403e('0x18')][_0x403e('0x15')]&&_0x3dfe14&&_0x3dfe14[_0x403e('0x6e')]&&_0x3dfe14[_0x403e('0x6e')][_0x403e('0x6f')][_0x403e('0x44')][_0x403e('0x70')]=='data_broker'||!this[_0x403e('0x18')][_0x403e('0x15')]){const _0x4c9925=new email_cron_1[(_0x403e('0x71'))](_0x1595d9,_0x393187,_0x3dfe14);_0x4c9925[_0x403e('0x72')]({'days':0x5a,'maxEmailSend':0x3});_0x2fde6f(!![]);}else{_0x2fde6f(![]);}});}['migrate'](_0x1d9a08){const _0x28dd36=[{'table':_0x403e('0x73')}];new mssql_to_postgres_1[(_0x403e('0x74'))](_0x1d9a08,_0x28dd36,this)[_0x403e('0x75')]();}[_0x403e('0x76')](_0x8cb993){if(this[_0x403e('0x18')]['environment']==_0x403e('0x77')){process['on'](_0x403e('0x78'),_0x5447ca=>console[_0x403e('0x22')](_0x5447ca));}_0x8cb993[_0x403e('0x3f')]((_0x3ac0b9,_0x15e48d,_0x255800,_0xf2b1c5)=>{if(!_0x3ac0b9){_0xf2b1c5();}else{if(this[_0x403e('0x18')][_0x403e('0x79')]==_0x403e('0x77')){console['error'](_0x3ac0b9[_0x403e('0x24')]);_0x255800[_0x403e('0x7a')](0x1f4)[_0x403e('0x7b')]({'error':_0x3ac0b9[_0x403e('0x24')]});}else if(this[_0x403e('0x18')]['environment']==_0x403e('0x62')){_0xf2b1c5();}}_0x15e48d[_0x403e('0x7c')]['on'](_0x403e('0x27'),()=>{if(this[_0x403e('0x18')][_0x403e('0x79')]==_0x403e('0x77')){console[_0x403e('0x22')](_0x403e('0x7d'));_0x255800['status'](0x1f4)[_0x403e('0x7b')]({'error':_0x3ac0b9[_0x403e('0x24')]});}else if(this[_0x403e('0x18')][_0x403e('0x79')]=='production'){_0xf2b1c5();}});});}['loadTennancy'](_0x49f809){return __awaiter(this,void 0x0,void 0x0,function*(){if(cluster&&cluster['isMaster']||!this['options'][_0x403e('0x15')]){return new Promise(_0x1d04cc=>{if(_0x49f809&&_0x49f809!=null&&_0x49f809!=undefined&&_0x49f809['query']!=null){_0x49f809[_0x403e('0x21')](_0x403e('0x7e'),null,(_0x5f4509,_0x758985)=>__awaiter(this,void 0x0,void 0x0,function*(){if(!_0x5f4509){if(_0x758985&&_0x758985[_0x403e('0x25')][_0x403e('0x4c')]>0x0){let _0x9ceb94=[];_0x758985['rows'][_0x403e('0x53')]((_0x1064a9,_0x4c66e3,_0x207e83)=>__awaiter(this,void 0x0,void 0x0,function*(){let _0x37f947=_0x1064a9[_0x403e('0x18')][_0x403e('0x33')]==process[_0x403e('0x44')][_0x403e('0x7f')];if(!_0x37f947){let _0x465df7=new API(_0x1064a9['options']);_0x9ceb94[_0x403e('0x4e')](_0x465df7['initialize'](_0x465df7[_0x403e('0x1d')],_0x1064a9[_0x403e('0x18')]));}}));if(_0x9ceb94&&_0x9ceb94[_0x403e('0x4c')]>0x0){return Promise[_0x403e('0x54')](_0x9ceb94)['then'](_0x194925=>{if(_0x194925&&_0x194925[_0x403e('0x4c')]>0x0){_0x194925[_0x403e('0x80')](_0x5665ac=>{_0x5665ac[_0x403e('0x56')](_0x37b681=>{_0x37b681[_0x403e('0x81')]();});});_0x1d04cc(_0x194925);}});}else{_0x1d04cc();}}else{_0x1d04cc();}}else{_0x1d04cc();}}));}else{_0x1d04cc([]);}});}else{Promise['resolve']([]);}});}[_0x403e('0x3d')](_0x3d80b2,_0x40cdf1){return __awaiter(this,void 0x0,void 0x0,function*(){return new Promise(_0x1899b5=>__awaiter(this,void 0x0,void 0x0,function*(){yield this[_0x403e('0x60')](_0x3d80b2);yield this[_0x403e('0x82')](_0x3d80b2);yield this[_0x403e('0x69')](_0x3d80b2);yield this[_0x403e('0x46')](_0x3d80b2);yield this[_0x403e('0x83')](this,_0x40cdf1,cluster);this[_0x403e('0x76')](_0x3d80b2);this[_0x403e('0x1a')]=!![];if(this['readyCallback'])this[_0x403e('0x84')](this);if(this['onReadyCallback'])this[_0x403e('0x85')](this);_0x1899b5(this);}));});}['ready'](_0x531f21){if(this['initialized']){_0x531f21(this);}else{this['readyCallback']=_0x531f21;}}[_0x403e('0x86')](_0x9bb457){if(this[_0x403e('0x1a')]){_0x9bb457(this);}else{this['onReadyCallback']=_0x9bb457;}}[_0x403e('0x87')](_0x520442,_0x18408e,_0x158f8b,_0x33317c,_0x597c28){return new Promise(_0x1000e5=>__awaiter(this,void 0x0,void 0x0,function*(){let _0x1380f0=new base_model_1['BaseModel'](this['options'],_0x520442,_0x18408e,_0x158f8b!=null?_0x158f8b:_0x403e('0x4b'),_0x33317c!=null?_0x33317c:[],this);this['models'][_0x403e('0x4e')](_0x1380f0[_0x403e('0x4d')]);this['schema'][_0x520442]=_0x1380f0[_0x403e('0x4d')];this[_0x403e('0x1d')]['use'](this[_0x403e('0x18')][_0x403e('0x88')]+'/'+_0x520442['toLowerCase'](),_0x1380f0['model'][_0x403e('0x50')]['make']());let _0x2b7e98=yield _0x1380f0[_0x403e('0x55')]();if(!_0x2b7e98[_0x403e('0x56')]){yield _0x2b7e98[_0x403e('0x55')]();}else{_0x2b7e98[_0x403e('0x57')](this[_0x403e('0x18')][_0x403e('0x58')]!=null?this['options'][_0x403e('0x58')]:_0x403e('0x89'),_0x2b7e98[_0x403e('0x8a')]);}_0x1000e5(_0x2b7e98['model']);return _0x2b7e98['model'];}));}['getModelByName'](_0x35097b){return this[_0x403e('0x19')]['filter'](_0x5dd64d=>{return _0x5dd64d[_0x403e('0x8b')][_0x403e('0x8a')]==_0x35097b;})[_0x403e('0x8c')]();}['getSchema'](_0x26b235){return this[_0x403e('0x49')][_0x26b235];}[_0x403e('0x61')](){return new Promise(_0x179678=>{this['pool']!=null?this[_0x403e('0x26')][_0x403e('0x21')](_0x403e('0x8d'),null,(_0xede439,_0x8a1ad3)=>{if(_0x8a1ad3&&_0x8a1ad3[_0x403e('0x25')][_0x403e('0x4c')]>0x0){_0x179678(_0x8a1ad3[_0x403e('0x25')][_0x403e('0x8e')](_0x5635ab=>{return _0x5635ab[_0x403e('0x8f')]==!![];})[_0x403e('0x4c')]>0x0);}else{_0x179678(![]);}}):_0x179678(![]);});}[_0x403e('0x81')](){if(this[_0x403e('0x18')][_0x403e('0x15')]&&!cluster[_0x403e('0x90')]||!this[_0x403e('0x18')][_0x403e('0x15')]){this[_0x403e('0x1c')]=http[_0x403e('0x91')](this[_0x403e('0x1d')]);this[_0x403e('0x1c')]['on'](_0x403e('0x92'),_0x5827c4=>{console[_0x403e('0x22')](_0x403e('0x93')+this[_0x403e('0x18')][_0x403e('0x33')]+_0x403e('0x94')+process[_0x403e('0x95')],this['server'][_0x403e('0x96')]());if(this[_0x403e('0x1c')][_0x403e('0x96')]()[_0x403e('0x1e')]!=this[_0x403e('0x1e')]){throw new Error('Server\x20not\x20listening\x20correctly\x20-\x20is\x20address\x20in\x20use?');}})['on'](_0x403e('0x97'),_0x2f35c1=>{})['on']('error',_0x29bdca=>{if(_0x29bdca[_0x403e('0x98')]==_0x403e('0x99')){console[_0x403e('0x22')]('Port:\x20'+this['port']+_0x403e('0x9a')+process[_0x403e('0x95')]+'!');setTimeout(()=>{this['server'][_0x403e('0x9b')]();},0x3e8);}})[_0x403e('0x9c')](this[_0x403e('0x1e')]);}return{'server':this[_0x403e('0x1c')],'api':this};}[_0x403e('0x9c')](){this[_0x403e('0x1c')]!=null?this[_0x403e('0x1c')][_0x403e('0x9c')](this[_0x403e('0x1e')]):null;}[_0x403e('0x9d')](){let _0x1f136c=[];if(cluster&&cluster[_0x403e('0x9e')]){for(let _0x4ee7eb in cluster[_0x403e('0x9e')]){_0x1f136c[_0x403e('0x4e')](_0x4ee7eb);}_0x1f136c[_0x403e('0x80')](_0x739c6b=>{cluster[_0x403e('0x9e')][_0x739c6b][_0x403e('0x7b')]({'cmd':_0x403e('0x9f'),'from':_0x403e('0xa0')});setTimeout(()=>{if(cluster[_0x403e('0x9e')][_0x739c6b]){cluster['workers'][_0x739c6b][_0x403e('0xa1')](_0x403e('0xa2'));}},0x1388);});}}}exports[_0x403e('0xa3')]=API;