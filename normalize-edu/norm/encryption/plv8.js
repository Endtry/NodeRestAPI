var _0x5a53=['proname','create','create\x20or\x20replace\x20function\x20plv8_init()\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20returns\x20void\x20as\x20$$\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20cache\x20=\x20{};\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20load\x20=\x20function(key,\x20source)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20var\x20module\x20=\x20{exports:\x20{}};\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20eval(\x22(function(module,\x20exports)\x20{\x22\x20+\x20source\x20+\x20\x22;\x20})\x22)(module,\x20module.exports);\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20//\x20store\x20in\x20cache\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20cache[key]\x20=\x20module.exports;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20return\x20module.exports;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20};\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20require\x20=\x20function(module)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20if(cache[module])\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20return\x20cache[module];\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20var\x20rows\x20=\x20plv8.execute(\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x27select\x20source\x20from\x20\x22PLV8Module\x22\x20where\x20module\x20=\x20$1\x27,\x20[module]\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20);\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20if(rows.length\x20===\x200)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20plv8.elog(NOTICE,\x20\x27cannot\x20load\x20module:\x20\x27\x20+\x20module);\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20return\x20null;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20return\x20load(module,\x20rows[0].source);\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20};\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20var\x20query\x20=\x20\x27select\x20module,\x20source\x20from\x20\x22PLV8Module\x22\x20where\x20autoload\x20=\x20true\x27;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20plv8.execute(query).forEach(function(row)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20load(row.module,\x20row.source);\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20});\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20$$\x20language\x20plv8;','select\x20*\x20from\x20\x22','\x22\x20where\x20\x22','\x22\x20=\x20\x27','rows','length','insert\x20into\x20\x22PLV8Module\x22\x20(module,\x20autoload,\x20source,\x20created_by,\x20updated_by)\x20values\x20(\x27','\x27,\x20','\x27,\x20\x27SYS\x27,\x20\x27SYS\x27);','PLV8','__awaiter','done','value','apply','next','defineProperty','__esModule','../file-manager/file-manager','cluster','dbName','PLV8Init','init','setup','createV8Extension','existCheck','pg_extension','extname','plv8','create\x20extension\x20plv8;','query','setStartProcess','ALTER\x20DATABASE\x20\x22','\x22\x20SET\x20plv8.start_proc\x20=\x20\x27','fetchCode','FileManager','readStream','plv8_init','pg_proc'];(function(_0x47d16c,_0x29baf2){var _0x31ec84=function(_0x16125b){while(--_0x16125b){_0x47d16c['push'](_0x47d16c['shift']());}};_0x31ec84(++_0x29baf2);}(_0x5a53,0x174));var _0x3a65=function(_0x1596a1,_0x41d08e){_0x1596a1=_0x1596a1-0x0;var _0x2256ab=_0x5a53[_0x1596a1];return _0x2256ab;};'use strict';var __awaiter=this&&this[_0x3a65('0x0')]||function(_0x27426d,_0x110852,_0x21ff31,_0x224a9f){return new(_0x21ff31||(_0x21ff31=Promise))(function(_0x1ec94c,_0x2546d4){function _0x158a94(_0x408284){try{_0x1aedd0(_0x224a9f['next'](_0x408284));}catch(_0x319dcd){_0x2546d4(_0x319dcd);}}function _0x5f282f(_0x4f53ac){try{_0x1aedd0(_0x224a9f['throw'](_0x4f53ac));}catch(_0x43a5f1){_0x2546d4(_0x43a5f1);}}function _0x1aedd0(_0x6e4318){_0x6e4318[_0x3a65('0x1')]?_0x1ec94c(_0x6e4318[_0x3a65('0x2')]):new _0x21ff31(function(_0x1ec94c){_0x1ec94c(_0x6e4318['value']);})['then'](_0x158a94,_0x5f282f);}_0x1aedd0((_0x224a9f=_0x224a9f[_0x3a65('0x3')](_0x27426d,_0x110852||[]))[_0x3a65('0x4')]());});};Object[_0x3a65('0x5')](exports,_0x3a65('0x6'),{'value':!![]});const file_manager_1=require(_0x3a65('0x7'));const cluster=require(_0x3a65('0x8'));class PLV8{constructor(_0x58e2f1,_0x1eb803){this['pg']=_0x58e2f1;this[_0x3a65('0x9')]=_0x1eb803;}['setup'](){return __awaiter(this,void 0x0,void 0x0,function*(){return new Promise(_0x53f163=>__awaiter(this,void 0x0,void 0x0,function*(){yield this['createV8Extension']();yield this[_0x3a65('0xa')](this['dbName']);_0x53f163(!![]);}));});}[_0x3a65('0xb')](){return __awaiter(this,void 0x0,void 0x0,function*(){return new Promise(_0x333738=>__awaiter(this,void 0x0,void 0x0,function*(){yield this[_0x3a65('0xc')]();_0x333738(this);}));});}[_0x3a65('0xd')](){return __awaiter(this,void 0x0,void 0x0,function*(){return new Promise(_0x3a442b=>__awaiter(this,void 0x0,void 0x0,function*(){let _0x16e451=yield this[_0x3a65('0xe')](_0x3a65('0xf'),_0x3a65('0x10'),_0x3a65('0x11'));if(!_0x16e451){const _0x189a82=_0x3a65('0x12');this['pg'][_0x3a65('0x13')](_0x189a82,(_0x1c893d,_0x5a5613)=>{if(_0x1c893d){_0x3a442b(_0x1c893d);}else{_0x3a442b(_0x5a5613);}});}else{_0x3a442b({});}}));});}[_0x3a65('0x14')](_0x252510,_0x47791c){return __awaiter(this,void 0x0,void 0x0,function*(){return new Promise(_0xd1ab2a=>{const _0x19f427=_0x3a65('0x15')+_0x47791c+_0x3a65('0x16')+_0x252510+'\x27;';this['pg'][_0x3a65('0x13')](_0x19f427,(_0xa6d111,_0x4b8c63)=>{if(_0xa6d111){_0xd1ab2a(_0xa6d111);}else{_0xd1ab2a(_0x4b8c63);}});});});}[_0x3a65('0x17')](_0x4d2d23){const _0x461df5=new file_manager_1[(_0x3a65('0x18'))]();return new Promise(_0xfb661a=>{_0x461df5[_0x3a65('0x19')](_0x4d2d23,{'returnType':'utf8'},_0x56a95c=>{_0xfb661a(_0x56a95c);});});}[_0x3a65('0xa')](_0x3033cd){return __awaiter(this,void 0x0,void 0x0,function*(){return new Promise(_0x1e6ed9=>__awaiter(this,void 0x0,void 0x0,function*(){yield this[_0x3a65('0x14')](_0x3a65('0x1a'),_0x3033cd);const _0xfe567d=yield this[_0x3a65('0xe')](_0x3a65('0x1b'),_0x3a65('0x1c'),_0x3a65('0x1a'));if(!_0xfe567d){let _0x7060f8=yield this[_0x3a65('0x1d')](_0x3a65('0x1e'));if(_0x7060f8){_0x1e6ed9(_0x7060f8);}}else{_0x1e6ed9({});}}));});}[_0x3a65('0x1d')](_0x56f807){return new Promise((_0x1e4dcc,_0x7856d7)=>{this['pg']['query'](_0x56f807,(_0x38154d,_0x1f81de)=>{if(_0x38154d){_0x1e4dcc(_0x38154d);}else{_0x1e4dcc(_0x1f81de);}});});}[_0x3a65('0xe')](_0x11fb8e,_0x46d432,_0x26d118){return new Promise(_0x26eccf=>{let _0x104fff=_0x3a65('0x1f')+_0x11fb8e+_0x3a65('0x20')+_0x46d432+_0x3a65('0x21')+_0x26d118+'\x27;';this['pg'][_0x3a65('0x13')](_0x104fff,(_0x3bb651,_0x566d55)=>{if(_0x3bb651){_0x26eccf(_0x3bb651);}else{const _0x49732b=_0x566d55&&_0x566d55[_0x3a65('0x22')][_0x3a65('0x23')]>0x0;_0x26eccf(_0x49732b);}});});}['insertModule'](_0x32ea00,_0x2dd51a,_0x1d8e51){return __awaiter(this,void 0x0,void 0x0,function*(){return new Promise(_0x41b501=>{let _0x43edea=_0x3a65('0x24')+_0x32ea00+_0x3a65('0x25')+_0x2dd51a+',\x20\x27'+_0x1d8e51+_0x3a65('0x26');this['pg'][_0x3a65('0x13')](_0x43edea,(_0x42e9ae,_0x241c89)=>{if(_0x42e9ae){_0x41b501(_0x42e9ae);}else{_0x41b501(_0x241c89);}});});});}}exports[_0x3a65('0x27')]=PLV8;