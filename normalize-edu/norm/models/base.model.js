var _0x3c82=['api','circular','ready','extend','make','customRoutes','init','buildTable','route','model','router','app','use','desc','toLowerCase','A\x20true/false\x20flag\x20use\x20to\x20show/hide\x20','\x20elements\x20on\x20the\x20client\x20application.\x20Useful\x20for\x20soft\x20delete\x20etc.','Active','A\x20string\x20property\x20used\x20to\x20capture\x20the\x20username\x20who\x20create\x20a\x20','\x20record.','Created\x20By','A\x20string\x20property\x20used\x20to\x20capture\x20the\x20username\x20who\x20update\x20a\x20','Updated\x20By','Created\x20At','now','A\x20date\x20property\x20used\x20to\x20capture\x20the\x20timestamp\x20when\x20a\x20','Updated\x20At','\x20record\x20is\x20permanently\x20deleted.','Deleted\x20At','assign','options','dbType','postgres','BaseRouter','controller','isArray','length','forEach','method','callback','checkTableExist','select\x20count(*)\x20from\x20pg_class\x20where\x20relname=\x27','rows','count','getNiceName','localtimestamp','SYS','getSchema','createTable','data','error','code','stack','indexOf','lastIndexOf','slice','failedAttempts','recreate','statusCode','errorCode','seed','seedDir','../../seed','checkCircular','repeats','push','A\x20table\x20auto\x20generated\x20by\x20normalize.','sort','filter','log','resolveModels','keys','reduce','resolve','fileManager','FileManager','normalize','/../../','trim','readFileSync','utf8','getAllSecretFields','count(*)','get','bulkInsert','\x22));','query','\x20$1\x20$2','replace','$1\x20$2','BaseModel','__awaiter','next','value','then','apply','__esModule','../controllers/base.controller','../file-manager/file-manager','mongoose','path','name','schema','description'];(function(_0x242ecc,_0x528af0){var _0x1e1be8=function(_0x1efd91){while(--_0x1efd91){_0x242ecc['push'](_0x242ecc['shift']());}};_0x1e1be8(++_0x528af0);}(_0x3c82,0x12b));var _0xa087=function(_0x29d45a,_0x20b398){_0x29d45a=_0x29d45a-0x0;var _0x22215a=_0x3c82[_0x29d45a];return _0x22215a;};'use strict';/*
    Required. The base model for all other models to extend from
*/var __awaiter=this&&this[_0xa087('0x0')]||function(_0x291ebd,_0x2d0e6a,_0x6e77c2,_0x230109){return new(_0x6e77c2||(_0x6e77c2=Promise))(function(_0x4c9db8,_0x439300){function _0x1a9870(_0x16d43f){try{_0x35bc5f(_0x230109[_0xa087('0x1')](_0x16d43f));}catch(_0x296519){_0x439300(_0x296519);}}function _0x3db635(_0x306cc8){try{_0x35bc5f(_0x230109['throw'](_0x306cc8));}catch(_0x390ae2){_0x439300(_0x390ae2);}}function _0x35bc5f(_0x1dcb08){_0x1dcb08['done']?_0x4c9db8(_0x1dcb08[_0xa087('0x2')]):new _0x6e77c2(function(_0x4c9db8){_0x4c9db8(_0x1dcb08[_0xa087('0x2')]);})[_0xa087('0x3')](_0x1a9870,_0x3db635);}_0x35bc5f((_0x230109=_0x230109[_0xa087('0x4')](_0x291ebd,_0x2d0e6a||[]))[_0xa087('0x1')]());});};Object['defineProperty'](exports,_0xa087('0x5'),{'value':!![]});const base_controller_1=require(_0xa087('0x6'));const base_router_1=require('../routes/base.router');const file_manager_1=require(_0xa087('0x7'));const mongoose=require(_0xa087('0x8'));const path=require(_0xa087('0x9'));class BaseModel{constructor(_0x1c3ee5,_0x2353ef,_0x1ce33e,_0x229887,_0xa3adc8,_0x5ab04a){this['options']=_0x1c3ee5;this[_0xa087('0xa')]=_0x2353ef;this[_0xa087('0xb')]=_0x1ce33e;this[_0xa087('0xc')]=_0x229887;this['customRoutes']=_0xa3adc8;this[_0xa087('0xd')]=_0x5ab04a;this['repeats']=[];this[_0xa087('0xe')]=![];this[_0xa087('0xf')]=![];this[_0xa087('0x10')](this[_0xa087('0xa')],this[_0xa087('0xb')])[_0xa087('0x11')](this['name'],this[_0xa087('0xb')],this[_0xa087('0x12')]);}[_0xa087('0x13')](){return __awaiter(this,void 0x0,void 0x0,function*(){return new Promise(_0x17fd46=>__awaiter(this,void 0x0,void 0x0,function*(){let _0x3df17b=yield this[_0xa087('0x14')](this[_0xa087('0xa')],this[_0xa087('0xb')],this[_0xa087('0xc')]!=null?this[_0xa087('0xc')]:'N/A');if(_0x3df17b){this[_0xa087('0xf')]=!![];}else{this[_0xa087('0xf')]=![];}_0x17fd46(this);}));});}[_0xa087('0x15')](_0x42db98,_0x378da8,_0x1682a4,_0x575cca){let _0x30efc6=this[_0xa087('0x16')][_0xa087('0x17')]['extend'](_0x42db98,_0x378da8,_0x1682a4,_0x575cca);if(_0x30efc6){this[_0xa087('0xd')][_0xa087('0x18')][_0xa087('0x19')]('/'+_0x42db98,_0x30efc6);}}[_0xa087('0x10')](_0xdf237d,_0x44e563){for(let _0x4deb49 in _0x44e563){if(_0x44e563[_0x4deb49][_0xa087('0x1a')]==null){_0x44e563[_0x4deb49][_0xa087('0x1a')]='';}if(_0x44e563[_0x4deb49]['nice_name']==null){_0x44e563[_0x4deb49]['nice_name']='';}}const _0x8e2b97=_0xdf237d[_0xa087('0x1b')]();const _0x2e911d={'active':{'type':Boolean,'default':!![],'desc':_0xa087('0x1c')+_0x8e2b97+_0xa087('0x1d'),'nice_name':_0xa087('0x1e')},'created_by':{'type':String,'maxlength':0x4b,'desc':_0xa087('0x1f')+_0x8e2b97+_0xa087('0x20'),'nice_name':_0xa087('0x21')},'updated_by':{'type':String,'maxlength':0x4b,'desc':_0xa087('0x22')+_0x8e2b97+_0xa087('0x20'),'nice_name':_0xa087('0x23')},'created_at':{'type':Date,'default':Date['now'](),'desc':'A\x20date\x20property\x20used\x20to\x20capture\x20the\x20timestamp\x20when\x20a\x20'+_0x8e2b97+'\x20record\x20is\x20created.','nice_name':_0xa087('0x24'),'timezone':!![]},'updated_at':{'type':Date,'default':Date[_0xa087('0x25')](),'desc':_0xa087('0x26')+_0x8e2b97+'\x20record\x20is\x20updated.','nice_name':_0xa087('0x27'),'timezone':!![]},'deleted_at':{'type':Date,'default':Date[_0xa087('0x25')](),'desc':_0xa087('0x26')+_0x8e2b97+_0xa087('0x28'),'nice_name':_0xa087('0x29'),'timezone':!![]}};this[_0xa087('0xb')]=Object[_0xa087('0x2a')](_0x44e563,_0x2e911d);return this;}['make'](_0x3796c7,_0x21ac54,_0xfc3595){return __awaiter(this,void 0x0,void 0x0,function*(){return new Promise(_0x2e0249=>__awaiter(this,void 0x0,void 0x0,function*(){switch(this[_0xa087('0x2b')][_0xa087('0x2c')]){case'mongo':let _0x221624=new mongoose['Schema'](_0x21ac54);this[_0xa087('0x16')]=mongoose['model'](_0x3796c7,_0x221624);break;case _0xa087('0x2d'):this[_0xa087('0x16')]={'model':this,'controller':null,'router':null,'schema':null};this[_0xa087('0x16')]['controller']=new base_controller_1['BaseController'](this[_0xa087('0x2b')],this[_0xa087('0xa')],this['model'],this[_0xa087('0xd')]);this[_0xa087('0x16')][_0xa087('0x17')]=new base_router_1[(_0xa087('0x2e'))](this[_0xa087('0x16')][_0xa087('0x2f')]);this[_0xa087('0x16')]['schema']=_0x21ac54;if(_0xfc3595&&Array[_0xa087('0x30')](_0xfc3595)&&_0xfc3595[_0xa087('0x31')]>0x0){_0xfc3595[_0xa087('0x32')](_0x8c1ce6=>{this[_0xa087('0x15')](_0x8c1ce6[_0xa087('0x15')],_0x8c1ce6[_0xa087('0x33')],_0x8c1ce6[_0xa087('0x34')](this[_0xa087('0x16')]),_0x8c1ce6['requireToken']);});}}return this;}));});}[_0xa087('0x35')](_0x150107,_0x1ddd9e){return new Promise(_0x3c3c45=>{const _0x570f5a=_0xa087('0x36')+_0x1ddd9e+'\x27\x20and\x20relkind=\x27r\x27';_0x150107['query'](_0x570f5a,(_0x3eb3cc,_0x40c164)=>__awaiter(this,void 0x0,void 0x0,function*(){if(_0x3eb3cc){_0x3c3c45(![]);}else{let _0x26e76a=_0x40c164&&_0x40c164[_0xa087('0x37')]&&_0x40c164[_0xa087('0x37')][_0xa087('0x31')]>0x0?_0x40c164['rows'][0x0][_0xa087('0x38')]:0x0;if(_0x26e76a&&_0x26e76a==0x1){_0x3c3c45(!![]);}else{_0x3c3c45(![]);}}}));});}[_0xa087('0x14')](_0x52de31,_0x5e3fbd,_0x5cd55f){return __awaiter(this,void 0x0,void 0x0,function*(){return new Promise(_0x31bee3=>__awaiter(this,void 0x0,void 0x0,function*(){if(this[_0xa087('0x2b')][_0xa087('0x2c')]=='mongo'){_0x31bee3(!![]);}else if(this[_0xa087('0x2b')][_0xa087('0x2c')]==_0xa087('0x2d')){const _0x4d1a83={'schema_name':_0x52de31,'schema_nice_name':this[_0xa087('0x39')](_0x52de31),'description':_0x5cd55f,'schema':_0x5e3fbd,'created_at':_0xa087('0x3a'),'updated_at':_0xa087('0x3a'),'created_by':_0xa087('0x3b'),'updated_by':'SYS'};const _0xd238e9={'schema':_0x5e3fbd,'schemaInsertPayload':_0x4d1a83};let _0x110eb5=this['api'][_0xa087('0x3c')](_0x52de31);_0x110eb5=_0x110eb5!=null?_0x110eb5[_0xa087('0x2f')]:this[_0xa087('0x16')][_0xa087('0x2f')];const _0x2dd35a=yield _0x110eb5[_0xa087('0x3d')](_0xd238e9,null,null);if(_0x2dd35a&&_0x2dd35a['data']&&_0x2dd35a[_0xa087('0x3e')][_0xa087('0x3f')]&&_0x2dd35a[_0xa087('0x3e')][_0xa087('0x3f')]['name']==_0xa087('0x3f')&&_0x2dd35a[_0xa087('0x3e')][_0xa087('0x3f')][_0xa087('0x40')]=='42P01'){let _0x351484=_0x52de31;let _0x202c60=_0x2dd35a['data']['error'][_0xa087('0x41')]['toString']();let _0x318984=_0x202c60[_0xa087('0x42')]('\x22')+0x1;let _0x4c66d8=_0x202c60[_0xa087('0x43')]('\x22');let _0x1d82bf=_0x202c60[_0xa087('0x44')](_0x318984,_0x4c66d8);BaseModel['failedAttempts'][_0x351484]==null?BaseModel[_0xa087('0x45')][_0x351484]={'table':_0x351484,'schema':_0x5e3fbd,'desc':_0x5cd55f}:![];let _0xebd70c=yield this[_0xa087('0x46')](_0x351484,_0x1d82bf,_0x5e3fbd,_0x5cd55f);if(!_0xebd70c){let _0x32b729=yield this[_0xa087('0x14')](_0x351484,_0x5e3fbd,_0x5cd55f);_0x31bee3(_0x32b729);}else{_0x31bee3(!![]);}}else if(_0x2dd35a&&_0x2dd35a[_0xa087('0x3e')]&&_0x2dd35a[_0xa087('0x3e')][_0xa087('0x47')]==0xc8&&!(_0x2dd35a[_0xa087('0x3e')][_0xa087('0x48')]==0x1f4)){let _0x197871=yield this[_0xa087('0x49')]('/seed',_0x52de31);let _0x426b95=yield this[_0xa087('0x49')](this['options'][_0xa087('0x4a')]!=null?this[_0xa087('0x2b')][_0xa087('0x4a')]:_0xa087('0x4b'),_0x52de31);_0x31bee3(!![]);}else{_0x31bee3(!![]);}}}));});}[_0xa087('0x46')](_0x39f0de,_0x3e06b0,_0x5be85e,_0x4a9793){return new Promise(_0xcb3354=>__awaiter(this,void 0x0,void 0x0,function*(){let _0x76a208=yield this[_0xa087('0x4c')](_0x3e06b0);if(_0x76a208){process['exit']();}else if(BaseModel['failedAttempts'][_0x3e06b0]!=null){this[_0xa087('0x4d')][_0xa087('0x4e')](_0x3e06b0);let _0x1bd054=BaseModel[_0xa087('0x45')][_0x3e06b0];let _0x10159b=yield this[_0xa087('0x14')](_0x3e06b0,_0x1bd054[_0xa087('0xb')],_0x1bd054[_0xa087('0x1a')]);if(_0x10159b){let _0x2626d8=yield this[_0xa087('0x14')](_0x39f0de,_0x5be85e,_0x4a9793);if(_0x2626d8){delete BaseModel['failedAttempts'][_0x3e06b0];_0xcb3354(_0x2626d8);}else{_0xcb3354(![]);}}else{let _0x10159b=yield this[_0xa087('0x14')](_0x39f0de,_0x5be85e,_0x4a9793);_0xcb3354(_0x10159b);}}else{let _0x467dba=this[_0xa087('0xd')][_0xa087('0x3c')](_0x3e06b0);let _0x36aa7d=yield this[_0xa087('0x14')](_0x3e06b0,_0x467dba[_0xa087('0xb')],_0xa087('0x4f'));if(_0x36aa7d){let _0x1c0d8f=yield this[_0xa087('0x14')](_0x39f0de,_0x5be85e,_0x4a9793);_0xcb3354(!![]);}else{_0xcb3354(![]);}}}));}[_0xa087('0x4c')](_0x20e18a){return new Promise(_0x61e689=>{let _0x2e6fd9=0x0;this[_0xa087('0x4d')]['reverse']()[_0xa087('0x32')]((_0x5bd44d,_0x33d60a,_0x2e21a0)=>{let _0x1ffe20=_0x2e21a0[0x0];if(!(_0x33d60a==0x0)){if(_0x5bd44d==_0x1ffe20){_0x2e6fd9++;}_0x2e6fd9>=0x5?this[_0xa087('0xe')]=!![]:![];}});if(this[_0xa087('0xe')]){let _0x32d8e9=this[_0xa087('0x4d')][_0xa087('0x50')]((_0x180400,_0x3d71e)=>{return _0x180400>_0x3d71e?-0x1:0x1;})[_0xa087('0x51')]((_0x1c2dce,_0x1d49e1,_0x3d7e17)=>{return!_0x1d49e1||_0x1c2dce!=_0x3d7e17[_0x1d49e1-0x1];});_0x61e689(!![]);console[_0xa087('0x52')]('Circular\x20Referenece!\x20Please\x20check\x20table\x20schema:\x20'+_0x32d8e9);}else{_0x61e689(![]);}});}[_0xa087('0x53')](){return new Promise(_0x466eb7=>{Object[_0xa087('0x54')](BaseModel[_0xa087('0x45')])[_0xa087('0x31')]>0x0?Object[_0xa087('0x54')](BaseModel['failedAttempts'])[_0xa087('0x55')]((_0x4731ce,_0x2909a1,_0x14fed3)=>__awaiter(this,void 0x0,void 0x0,function*(){yield _0x4731ce;let _0x432728=BaseModel[_0xa087('0x45')][_0x2909a1]||![];if(_0x432728){let _0x175872=this[_0xa087('0xd')][_0xa087('0x3c')](_0x2909a1)[_0xa087('0x2f')];let _0x2eb05a=yield this[_0xa087('0x35')](_0x175872,_0x2909a1);if(!_0x2eb05a){let _0x16932f=yield this['buildTable'](_0x2909a1,_0x432728['schema'],_0x432728[_0xa087('0x1a')]);if(_0x16932f){delete BaseModel[_0xa087('0x45')][_0x2909a1];}}return!![];}return!![];}),Promise[_0xa087('0x56')]()):[];_0x466eb7(!![]);});}[_0xa087('0x49')](_0x5573bb,_0x506498){return __awaiter(this,void 0x0,void 0x0,function*(){const _0x79411e=this[_0xa087('0xd')][_0xa087('0x3c')](_0x506498)[_0xa087('0x2f')];return new Promise(_0x412f13=>{this[_0xa087('0x57')]=new file_manager_1[(_0xa087('0x58'))]();const _0x4a5fb9=path[_0xa087('0x59')](__dirname+_0xa087('0x5a')+_0x5573bb);this['fileManager']['readDir'](_0x4a5fb9,(_0x5a231f,_0x32c1e8)=>__awaiter(this,void 0x0,void 0x0,function*(){if(_0x32c1e8&&_0x32c1e8[_0xa087('0x31')]>0x0){let _0x155dc5=[];let _0x5bd1c0=_0x32c1e8['filter']((_0x5846d1,_0x3ebc5f,_0x249b33)=>{if(_0x5846d1[_0xa087('0x42')]('.seed.js')!==-0x1){const _0xa1bbd9=_0x5846d1[_0xa087('0x44')](0x0,_0x5846d1['indexOf']('.seed.js'));return _0xa1bbd9[_0xa087('0x5b')]()[_0xa087('0x1b')]()==_0x506498[_0xa087('0x5b')]()[_0xa087('0x1b')]();}})['reduce']((_0x43eaec,_0xec48ac,_0xa7179d,_0x5202d7)=>__awaiter(this,void 0x0,void 0x0,function*(){yield _0x43eaec;const _0x402a01=path[_0xa087('0x56')](__dirname,_0x4a5fb9+'/'+_0xec48ac);const _0x3e3617=this['fileManager'][_0xa087('0x5c')](_0x402a01,_0xa087('0x5d'),{'toJSON':!![]});const _0x3b0f08={'secretFields':_0x79411e[_0xa087('0x5e')](),'body':_0x3e3617};const _0x5e4a6e={'body':{'get':[_0xa087('0x5f')]}};const _0x258e55=yield _0x79411e[_0xa087('0x60')](_0x5e4a6e,null,null);const _0x2d0f4b=_0x258e55&&_0x258e55['data']!=null?_0x258e55[_0xa087('0x3e')]:[];if(_0x2d0f4b!=null&&_0x2d0f4b[_0xa087('0x31')]>0x0&&parseInt(_0x2d0f4b[0x0][_0xa087('0x38')])==0x0){let _0x43eaec=yield _0x79411e[_0xa087('0x61')](_0x3b0f08,null,null);_0x155dc5[_0xa087('0x4e')](_0x43eaec);return _0x155dc5;}else{}}),Promise[_0xa087('0x56')]());let _0x4a30c5=yield _0x5bd1c0;if(_0x4a30c5&&_0x4a30c5['length']>0x0&&_0x4a30c5[0x0]['data']&&_0x4a30c5[0x0][_0xa087('0x3e')][_0xa087('0x31')]>0x0){let _0x3eda96='SELECT\x20setval(\x27\x22'+_0x506498+'_id_seq\x22\x27,\x20(SELECT\x20MAX(id)\x20FROM\x20\x22'+_0x506498+_0xa087('0x62');_0x79411e[_0xa087('0x63')](_0x3eda96,(_0x5a231f,_0x3a9677)=>__awaiter(this,void 0x0,void 0x0,function*(){if(_0x5a231f){}else{}}));}_0x412f13(!![]);}else{_0x412f13(!![]);}}));});});}[_0xa087('0x39')](_0x1ad2ed){return _0x1ad2ed['replace'](/([A-Z]+)([A-Z][a-z])/g,_0xa087('0x64'))[_0xa087('0x65')](/([a-z\d])([A-Z])/g,_0xa087('0x66'))[_0xa087('0x65')](/([a-zA-Z])(\d)/g,_0xa087('0x66'))['replace'](/^./,function(_0x1ad2ed){return _0x1ad2ed['toUpperCase']();})[_0xa087('0x5b')]();}}BaseModel[_0xa087('0x45')]={};exports[_0xa087('0x67')]=BaseModel;