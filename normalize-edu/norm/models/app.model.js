var _0x4e56=['env','DB_PASS','DB_PORT','api_key_id','Normalize','../models','bootstrap','sendError','POST','route','/tennant','/get','App','__awaiter','next','throw','done','value','apply','defineProperty','__esModule','../normalize','BaseModel','primary','options','name','api','getLogo','getSchema','DocumentBlob','controller','findById','data','postfix','split','.jpg','.gif','.svg+xml','image/','data:',';base64,','blob','getAll','model','get','getApi','appOptions','length','map','option_key','bg_logo','sm_logo','assign','all','json','createApi','body','hash','api_secret','cluster','api_prefix','environment','development','db_type','postgres','port','app_name'];(function(_0x5d4cac,_0x1ec44a){var _0x1f5dc7=function(_0x5cdf16){while(--_0x5cdf16){_0x5d4cac['push'](_0x5d4cac['shift']());}};_0x1f5dc7(++_0x1ec44a);}(_0x4e56,0x15c));var _0x3bed=function(_0x117dd1,_0x275e0c){_0x117dd1=_0x117dd1-0x0;var _0x157173=_0x4e56[_0x117dd1];return _0x157173;};'use strict';/*
    Required.
*/var __awaiter=this&&this[_0x3bed('0x0')]||function(_0xb9f5b5,_0x163259,_0x2a443a,_0x54d718){return new(_0x2a443a||(_0x2a443a=Promise))(function(_0x42e654,_0x34403c){function _0x348891(_0x42cc9a){try{_0x33d1a3(_0x54d718[_0x3bed('0x1')](_0x42cc9a));}catch(_0x5d0931){_0x34403c(_0x5d0931);}}function _0x3d7b3b(_0x417553){try{_0x33d1a3(_0x54d718[_0x3bed('0x2')](_0x417553));}catch(_0x22c31f){_0x34403c(_0x22c31f);}}function _0x33d1a3(_0x3fb95f){_0x3fb95f[_0x3bed('0x3')]?_0x42e654(_0x3fb95f[_0x3bed('0x4')]):new _0x2a443a(function(_0x42e654){_0x42e654(_0x3fb95f[_0x3bed('0x4')]);})['then'](_0x348891,_0x3d7b3b);}_0x33d1a3((_0x54d718=_0x54d718[_0x3bed('0x5')](_0xb9f5b5,_0x163259||[]))[_0x3bed('0x1')]());});};Object[_0x3bed('0x6')](exports,_0x3bed('0x7'),{'value':!![]});const base_model_1=require('./base.model');const normalize_1=require(_0x3bed('0x8'));class App extends base_model_1[_0x3bed('0x9')]{constructor(_0x347932,_0x99c1f0,_0x4fc6a6){super(_0x347932,_0x99c1f0,{'id':{'type':Number,'key':_0x3bed('0xa')},'app_name':{'type':String,'maxlength':0x18,'unique':!![]},'url':{'type':String,'maxlength':0xc8},'port':{'type':Number,'unique':!![]},'version':{'type':String,'maxlength':0xa},'api_prefix':{'type':String,'maxlength':0xa},'environment':{'type':String,'maxlength':0x18},'db_type':{'type':String,'maxlength':0x18},'cluster':{'type':Boolean,'default':![]},'primary':{'type':Boolean,'default':![]},'api_key_id':{'type':String,'maxlength':0x1f4},'api_secret':{'type':String,'maxlength':0x1f4},'options':{'type':JSON}},'',[],_0x4fc6a6);this[_0x3bed('0xb')]=_0x347932;this[_0x3bed('0xc')]=_0x99c1f0;this[_0x3bed('0xd')]=_0x4fc6a6;this[_0x3bed('0xe')]=(_0x4b0e77,_0x59cb48,_0x5ab63b)=>__awaiter(this,void 0x0,void 0x0,function*(){const _0x4c5238=this['api'][_0x3bed('0xf')](_0x3bed('0x10'))[_0x3bed('0x11')];let _0x315987=yield _0x4c5238[_0x3bed('0x12')](_0x4b0e77,null,null);if(_0x315987[_0x3bed('0x13')]){let _0x5ba1b8=_0x315987[_0x3bed('0x13')][_0x3bed('0x14')][_0x3bed('0x15')]('.')[0x1];if(_0x315987[_0x3bed('0x13')]['postfix']=='.png'||_0x315987[_0x3bed('0x13')][_0x3bed('0x14')]==_0x3bed('0x16')||_0x315987[_0x3bed('0x13')][_0x3bed('0x14')]=='.jpeg'||_0x315987['data']['postfix']==_0x3bed('0x17')||_0x315987[_0x3bed('0x13')]['postfix']==_0x3bed('0x18')){let _0x12ace2=_0x3bed('0x19')+_0x5ba1b8;return _0x3bed('0x1a')+_0x12ace2+_0x3bed('0x1b')+_0x315987[_0x3bed('0x13')][_0x3bed('0x1c')];}}else{return null;}});this[_0x3bed('0x1d')]=(_0x14816d,_0x4320a2,_0x13ae66)=>__awaiter(this,void 0x0,void 0x0,function*(){const _0x92e702=yield this[_0x3bed('0x1e')][_0x3bed('0x11')][_0x3bed('0x1f')](_0x14816d,_0x4320a2,_0x13ae66);});this[_0x3bed('0x20')]=(_0x5a1977,_0x4d43b6,_0x58df5c)=>__awaiter(this,void 0x0,void 0x0,function*(){const _0xcc9ef=yield this['model'][_0x3bed('0x11')][_0x3bed('0x1f')](_0x5a1977,null,null);let _0x45cc7a=_0xcc9ef&&_0xcc9ef['data']&&_0xcc9ef[_0x3bed('0x13')]['length']>0x0&&_0xcc9ef[_0x3bed('0x13')][0x0][_0x3bed('0x21')]&&_0xcc9ef[_0x3bed('0x13')][0x0][_0x3bed('0x21')]['length']>0x0?_0xcc9ef[_0x3bed('0x13')][0x0]['appOptions']:[];let _0x3d813c={};let _0x347932=_0x45cc7a[_0x3bed('0x22')]>0x0?_0x45cc7a[_0x3bed('0x23')]((_0x21abd1,_0x137b45,_0x5e4b5c)=>__awaiter(this,void 0x0,void 0x0,function*(){if(_0x21abd1[_0x3bed('0x24')]==_0x3bed('0x25')||_0x21abd1[_0x3bed('0x24')]==_0x3bed('0x26')){let _0x3c434e=_0x21abd1['option_value'];let _0x5d87bf={'params':{'id':_0x3c434e}};let _0x17ea2c=yield this['getLogo'](_0x5d87bf,null,null);_0x3d813c['option_value']=_0x17ea2c;}_0x21abd1=Object[_0x3bed('0x27')](_0x21abd1,_0x3d813c);return _0x21abd1;})):[];let _0x433dfc=yield Promise[_0x3bed('0x28')](_0x347932);_0xcc9ef[_0x3bed('0x13')]['appOptions']=_0x347932;_0x4d43b6[_0x3bed('0x29')](_0xcc9ef);});this[_0x3bed('0x2a')]=(_0x4038f6,_0x2c2760,_0x320051)=>__awaiter(this,void 0x0,void 0x0,function*(){_0x4038f6[_0x3bed('0x2b')]['api_key_id']=this[_0x3bed('0x1e')]['controller'][_0x3bed('0x2c')]();_0x4038f6[_0x3bed('0x2b')][_0x3bed('0x2d')]=this[_0x3bed('0x1e')][_0x3bed('0x11')]['hash']();_0x4038f6[_0x3bed('0x2b')][_0x3bed('0x2e')]=_0x4038f6['body'][_0x3bed('0x2e')]!=null?_0x4038f6['body'][_0x3bed('0x2e')]:![];_0x4038f6[_0x3bed('0x2b')][_0x3bed('0xa')]=_0x4038f6[_0x3bed('0x2b')][_0x3bed('0xa')]!=null?_0x4038f6[_0x3bed('0x2b')][_0x3bed('0xa')]:![];_0x4038f6[_0x3bed('0x2b')][_0x3bed('0x2f')]=_0x4038f6[_0x3bed('0x2b')][_0x3bed('0x2f')]!=null?_0x4038f6['body']['api_prefix']:'/api/v1';_0x4038f6['body'][_0x3bed('0x30')]=_0x4038f6[_0x3bed('0x2b')][_0x3bed('0x30')]!=null?_0x4038f6[_0x3bed('0x2b')][_0x3bed('0x30')]:_0x3bed('0x31');_0x4038f6[_0x3bed('0x2b')][_0x3bed('0x32')]=_0x4038f6[_0x3bed('0x2b')][_0x3bed('0x32')]!=null?_0x4038f6[_0x3bed('0x2b')]['db_type']:_0x3bed('0x33');const _0x347932=_0x4038f6[_0x3bed('0x2b')];let _0x186f93={'cluster':_0x347932[_0x3bed('0x2e')]||![],'seedDir':'/seed','port':parseInt(_0x347932[_0x3bed('0x34')]),'routePrefix':_0x347932[_0x3bed('0x2f')]||'/api/v1','environment':_0x347932[_0x3bed('0x30')]||_0x3bed('0x31'),'dbType':_0x347932[_0x3bed('0x32')]||_0x3bed('0x33'),'dbName':_0x347932[_0x3bed('0x35')]+'_'+process[_0x3bed('0x36')]['DB_NAME'],'dbUser':process[_0x3bed('0x36')]['DB_USER'],'dbPassword':process[_0x3bed('0x36')][_0x3bed('0x37')],'dbHost':process[_0x3bed('0x36')]['DB_HOST'],'dbPort':process[_0x3bed('0x36')][_0x3bed('0x38')],'api_key_id':_0x347932[_0x3bed('0x39')],'api_secret':_0x347932[_0x3bed('0x2d')]};_0x4038f6[_0x3bed('0x2b')][_0x3bed('0xb')]=Object['assign']({},_0x186f93);const _0x6fc60f=yield this['model'][_0x3bed('0x11')]['insert'](_0x4038f6,null,null);if(_0x6fc60f){let _0x13ca31=new normalize_1[(_0x3bed('0x3a'))](_0x186f93,{});_0x13ca31['ready'](_0x52d1c5=>__awaiter(this,void 0x0,void 0x0,function*(){const _0x471f75=require(_0x3bed('0x3b'));let _0x438bc3=yield _0x52d1c5[_0x3bed('0x3c')](_0x471f75,![]);if(_0x438bc3){_0x2c2760[_0x3bed('0x29')](_0x6fc60f);_0x52d1c5['spawn']();}else{_0x2c2760[_0x3bed('0x29')](this[_0x3bed('0x1e')]['controller'][_0x3bed('0x3d')](0x1f4,'Failed\x20to\x20spin\x20up\x20new\x20application\x20instance!'));}}));}});this['route']('/',_0x3bed('0x3e'),this[_0x3bed('0x2a')],!![]);this[_0x3bed('0x3f')](_0x3bed('0x40'),_0x3bed('0x3e'),this[_0x3bed('0x20')],![]);this[_0x3bed('0x3f')](_0x3bed('0x41'),_0x3bed('0x3e'),this[_0x3bed('0x1d')],![]);}}exports[_0x3bed('0x42')]=App;